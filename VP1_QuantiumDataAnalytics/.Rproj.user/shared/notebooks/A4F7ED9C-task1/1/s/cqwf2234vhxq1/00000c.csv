"0",""
"0","total_sales <- data %>% group_by(LIFESTAGE,PREMIUM_CUSTOMER)"
"0",""
"0","pf.total_sales <- summarise(total_sales,sales_count=sum(TOT_SALES))"
"0",""
"0","summary(pf.total_sales)"
"1",""
"1","                  LIFESTAGE"
"1","   PREMIUM_CUSTOMER"
"1","
"
"1"," MIDAGE SINGLES/COUPLES:3  "
"1"," Budget    :7      "
"1","
"
"1"," NEW FAMILIES          :3  "
"1"," Mainstream:7      "
"1","
"
"1"," OLDER FAMILIES        :3  "
"1"," Premium   :7      "
"1","
"
"1"," OLDER SINGLES/COUPLES :3  "
"1","                   "
"1","
"
"1"," RETIREES              :3  "
"1","                   "
"1","
"
"1"," YOUNG FAMILIES        :3  "
"1","                   "
"1","
"
"1"," YOUNG SINGLES/COUPLES :3  "
"1","                   "
"1","
"
"1",""
"1","  sales_count    "
"1","
"
"1"," Min.   : 10761  "
"1","
"
"1"," 1st Qu.: 54444  "
"1","
"
"1"," Median : 86338  "
"1","
"
"1"," Mean   : 85961  "
"1","
"
"1"," 3rd Qu.:124649  "
"1","
"
"1"," Max.   :156864  "
"1","
"
"1","                 "
"1","
"
"0","#### Create plot"
"0","p <- ggplot(pf.total_sales) + geom_mosaic(aes(weight = sales_count, x = product(PREMIUM_CUSTOMER, LIFESTAGE),fill = PREMIUM_CUSTOMER)) + labs(x = ""Lifestage"", y = ""Premium customer flag"", title = ""Proportion of sales"") + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) + geom_text(data = ggplot_build(p)$data[[1]], aes(x = (xmin + xmax)/2 , y = (ymin + ymax)/2, label = as.character(paste(round(.wt/sum(.wt),3)*100, '%'))), inherit.aes = F)"
"0",""
"0","p"
