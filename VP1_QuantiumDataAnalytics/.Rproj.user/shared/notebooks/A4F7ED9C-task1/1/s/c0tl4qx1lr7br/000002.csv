"0","total_sales <- data %>% group_by(LIFESTAGE,PREMIUM_CUSTOMER)"
"0",""
"0","no_of_customers <- summarise(total_sales,customer_count = length(unique(LYLTY_CARD_NBR))) "
"0","  "
"0","summary(no_of_customers)"
"1",""
"1","                  LIFESTAGE"
"1","   PREMIUM_CUSTOMER"
"1"," customer_count"
"1","
"
"1"," MIDAGE SINGLES/COUPLES:3  "
"1"," Budget    :7      "
"1"," Min.   : 575  "
"1","
"
"1"," NEW FAMILIES          :3  "
"1"," Mainstream:7      "
"1"," 1st Qu.:2369  "
"1","
"
"1"," OLDER FAMILIES        :3  "
"1"," Premium   :7      "
"1"," Median :3298  "
"1","
"
"1"," OLDER SINGLES/COUPLES :3  "
"1","                   "
"1"," Mean   :3395  "
"1","
"
"1"," RETIREES              :3  "
"1","                   "
"1"," 3rd Qu.:4611  "
"1","
"
"1"," YOUNG FAMILIES        :3  "
"1","                   "
"1"," Max.   :7917  "
"1","
"
"1"," YOUNG SINGLES/COUPLES :3  "
"1","                   "
"1","               "
"1","
"
"0","#### Create plot"
"0","p <‐ ggplot(data = no_of_customers) + geom_mosaic(aes(weight = customer_count, x = product(PREMIUM_CUSTOMER, LIFESTAGE), fill = PREMIUM_CUSTOMER)) + labs(x = ""Lifestage"", y = ""Premium customer flag"", title = ""Proportion of customers"") + theme(axis.text.x = element_text(angle = 90, vjust = 0.5))+ geom_text(data = ggplot_build(p)$data[[1]], aes(x = (xmin + xmax)/2 , y = (ymin + ymax)/2, label = as.character(paste(round(.wt/sum(.wt),3)*100, '%'))))"
"0",""
"0",""
"0","p"
